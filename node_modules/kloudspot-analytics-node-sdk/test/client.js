//Global "require"s
moment = require('../node_modules/moment');

//1) Import Kloudspot Analytics library
var KloudspotInsights = require('../index.js');

//2) Create a Kloudspot Analytics client
var ksClient = new KloudspotInsights({
	'host': '<your kloudspot instance baseurl>',
	'id': '<your kloudspot clientID>',
	'secretKey': '<your kloudspot clientSecret>'
});


//Example GET call
ksClient.siteHierarchy.sites().then(function(response) {
 	//Response should contain all the sites in the system
 	if(response && Array.isArray(response)) {
 		console.log('Number of sites in the system: '+response.length);
 	} else {
 		console.log(response);
 	}
 });


//Example POST call
 ksClient.machinelearning.predict({"endTime":moment().add(1, 'days').valueOf(),"locationIds":["63a1c2da811a3c66b2e15e0a","63a2b899811a3c66b2e1656e","63a1c320811a3c66b2e15e17","63a3090dda4f2f00dca1c225","63a30925da4f2f00dca1c23c","63a3093dda4f2f00dca1c254"],"modelInstanceId":"modelv3","threshold_waittime":180,"personel":null,"startTime":moment().valueOf(),"inactiveLocationIds":null}).then(function(response) {
 	//Response should contain all the entries and exits
 	if(response) {
 		console.log(JSON.stringify(response));
 	} else {
 		console.log('Error gettting data');
 	}
 });


// Example POST call

// Get all user entries and exits in the last 1 month
// ksClient.visionAnalytics.peopleEntryExit({
// 	"start": moment().subtract(30, 'days').valueOf(),
// 	"finish": moment().valueOf(),
// 	"locations": ["6458d926fd21bb34f8f3c769"]
// }).then(function(response) {
// 	//Response should contain all the entries and exits
// 	if(response) {
// 		console.log('Total Number of entries in the given location: '+response.entryCount);
// 		console.log('Total Number of exits in the given location: '+response.exitCount);
// 		const userArray = response.movements.map(m => m.firstName+' '+m.lastName);
// 		const userSet = new Set(userArray);
// 		console.log('Here is a list of the users who entered and exited the location : ', [...userSet].join(', '));
// 	} else {
// 		console.log('Error gettting data');
// 	}
// });

/*
ksClient.analyticsResource.postClientMovements({"location":["659e3c1191178133cfedbe0a"],
finish:1705587603000,"start": 1674051603000}).then(function(response) {
  if(!response) {
	console.log("error getting postClient moment",response);
  }
  else{
	console.log("here is the response",JSON.stringify(response));
}
});



ksClient.analyticsResource.getDailyPresence("1c:9d:c2:c2:1b:5a").then(function(response) {
	if(response) {
		
		console.log("daily presence ",JSON.stringify(response));
	  }
	  else{
		console.log("error getting postClient moment",response);
	}
	
});
*/

// ksClient.analyticsResource.getDeviceDemographics().then(function(response) {
// 	if(response.description) {
// 		console.log("error getting postClient moment",response.description);
// 	  }
// 	  else{
// 		console.log("device demographics ",JSON.stringify(response));
// 	}
	
// });


